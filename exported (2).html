<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bookly Library</title>
<style>
body { 
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; 
  margin: 0; 
  background: linear-gradient(135deg,#1e1e2f,#2b2b2b);    
  color:#f5f5dc; 
}

/* Top Bar */
.top-bar {
  display:flex; justify-content:flex-end; gap:15px; padding:15px 35px;
  background: rgba(62,39,35,0.95); border-radius:0 0 20px 20px;
  box-shadow:0 4px 18px rgba(0,0,0,0.5); position:sticky; top:0; z-index:1000;
}
.top-bar button {
  padding:12px 25px; border:none; border-radius:30px; cursor:pointer; font-weight:bold;
  font-size:15px; transition: all 0.3s ease; box-shadow:0 4px 12px rgba(0,0,0,0.3);
}
.btn-login {background:#4e342e;color:#f5f5dc;}
.btn-login:hover {background:#3e2723; transform:scale(1.08); box-shadow:0 8px 20px rgba(0,0,0,0.6);}
.btn-signup {background:#6d4c41;color:#f5f5dc;}
.btn-signup:hover {background:#5d4037; transform:scale(1.08); box-shadow:0 8px 20px rgba(0,0,0,0.6);}

/* Header */
h1 {text-align:center;margin:0;padding:30px 0;font-size:38px;
background: linear-gradient(135deg,#4e342e,#795548);
color:#f5f5dc; box-shadow:0 6px 18px rgba(0,0,0,0.4); border-bottom:2px solid #ff6f61;}

/* Book Grid */
.grid {
  display:grid;
  grid-template-columns: repeat(auto-fill,minmax(220px,1fr));
  gap:30px;
  padding:35px;
}
.book {
  position:relative;
  border-radius:20px;
  overflow:hidden;
  cursor:pointer;
  background: rgba(245,245,220,0.12);
  box-shadow:0 10px 28px rgba(0,0,0,0.5);
  transition: all 0.35s ease;
}
.book:hover { 
  transform: translateY(-10px) scale(1.05); 
  background: rgba(245,245,220,0.22); 
  box-shadow: 0 18px 40px rgba(0,0,0,0.7);
  filter: drop-shadow(0 0 10px #fff5);
}
.cover { position: relative; }
.cover img {
  width:100%;
  height:280px;
  object-fit:cover;
  border-radius:15px 15px 0 0;
  transition: transform 0.35s ease;
}
.book:hover .cover img { transform: scale(1.08); }
.cover .overlay {
  position:absolute;
  bottom:8px; left:8px;
  background: rgba(62,39,35,0.85); 
  color:#fff;
  padding:5px 10px;
  border-radius:6px;
  font-size:13px;
  font-weight:bold;
  box-shadow:0 2px 5px rgba(0,0,0,0.5);
}

/* Hardcover / Softcopy Badge */
.badge {
  position:absolute;
  top:8px;
  right:8px;
  background: linear-gradient(135deg,#ff9800,#ffb74d);
  color:#fff;
  padding:5px 12px;
  border-radius:15px;
  font-size:12px;
  font-weight:bold;
  text-shadow:0 1px 2px rgba(0,0,0,0.5);
  box-shadow: 0 2px 8px rgba(0,0,0,0.4);
}

/* Book Info */
.info { padding:16px; }
.info h3 { margin:0 0 10px; font-size:20px; font-weight:600; color:#fff; text-shadow:1px 1px 2px #000;}
.info p { margin:4px 0; color:#ddd; font-size:14px; }

/* Modals */
@keyframes fadeInModal {
  0% {opacity:0; transform:scale(0.9);}
  100% {opacity:1; transform:scale(1);}
}
.modal {
  display:none;
  position:fixed; top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.85);
  justify-content:center; align-items:center;
  backdrop-filter:blur(6px);
  z-index:2000;
}
.modal.show {
  display:flex;
  animation: fadeInModal 0.3s ease forwards;
}
.modal-content {
  background: linear-gradient(145deg,#2b2b2b,#1e1e2f);
  padding:25px;
  border-radius:20px;
  width:90%;
  max-width:700px;
  max-height:85%;
  overflow-y:auto;
  position:relative;
  box-shadow:0 15px 40px rgba(0,0,0,0.8);
  color:#fff;
  font-size:14px;
}
.modal-content h2 {
  margin-top:0;
  font-size:24px;
  color:#ff6f61;
  text-align:center;
  letter-spacing:0.5px;
  text-shadow:1px 1px 2px #000;
}
.close {
  position:absolute; top:12px; right:18px;
  font-size:28px;
  font-weight:bold;
  cursor:pointer;
  color:#ff6f61;
  transition: transform 0.25s ease, color 0.25s ease;
}
.close:hover { color:#ffa07a; transform:scale(1.2); }
.actions { margin-top:15px; display:flex; gap:10px; flex-wrap:wrap; }
.btn { flex:1; padding:12px; font-size:15px; border-radius:15px; font-weight:600; cursor:pointer; transition:all 0.25s ease; }

/* Modal Buttons */
.btn-buy { background:#4e342e; color:#f5f5dc; box-shadow:0 4px 15px rgba(0,0,0,0.5);}
.btn-buy:hover { background:#3e2723; transform: scale(1.05); }
.btn-rent { background:#6d4c41; color:#f5f5dc; box-shadow:0 4px 15px rgba(0,0,0,0.5);}
.btn-rent:hover { background:#5d4037; transform: scale(1.05); }

/* Forms */
form { display:flex; flex-direction:column; gap:15px; }
form input { padding:14px 18px; border-radius:15px; border:1px solid #555; font-size:14px; background:#1e1e2f; color:#fff; }
form input::placeholder { color:#bbb; }
form button { background:#4e342e; color:#f5f5dc; border:none; padding:14px; border-radius:15px; font-weight:bold; cursor:pointer; transition:all 0.25s ease; }
form button:hover { background:#3e2723; transform:scale(1.05); }
</style>
</head>
<body>

<div class="top-bar">
  <button class="btn-login">Login</button>
  <button class="btn-signup">Sign Up</button>
</div>

<h1>Bookly Library</h1>
<div id="books" class="grid"></div>

<!-- Book Modal -->
<div id="bookModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <div id="modalBody"></div>
  </div>
</div>

<!-- Login Modal -->
<div id="loginModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Login</h2>
    <form id="loginForm">
      <input type="text" placeholder="Username" required>
      <input type="password" placeholder="Password" required>
      <button type="submit">Login</button>
    </form>
  </div>
</div>

<!-- Signup Modal -->
<div id="signupModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Sign Up</h2>
    <form id="signupForm">
      <input type="text" placeholder="Username" required>
      <input type="email" placeholder="Email" required>
      <input type="password" placeholder="Password" required>
      <button type="submit">Register</button>
    </form>
  </div>
</div>

<script>
const bookModal = document.getElementById("bookModal");
const modalBody = document.getElementById("modalBody");
const loginModal = document.getElementById("loginModal");
const signupModal = document.getElementById("signupModal");

function openModal(modal){
  modal.classList.add('show');
}
function closeModal(modal){
  modal.classList.remove('show');
}

document.querySelector(".btn-login").onclick = () => openModal(loginModal);
document.querySelector(".btn-signup").onclick = () => openModal(signupModal);

document.querySelectorAll(".close").forEach(btn=>{
  btn.onclick = ()=>{ closeModal(btn.parentElement.parentElement); }
});
window.onclick=(e)=>{ if(e.target.classList.contains("modal")) closeModal(e.target); };

document.getElementById("loginForm").onsubmit = e => { e.preventDefault(); alert("تم تسجيل الدخول!"); closeModal(loginModal); }
document.getElementById("signupForm").onsubmit = e => { e.preventDefault(); alert("تم التسجيل!"); closeModal(signupModal); }

const API_URL = "http://localhost:8080/api/books";
const categoryColors = {
  "Fiction": "#ffe0b2",
  "Science": "#b3e5fc",
  "History": "#d7ccc8",
  "Fantasy": "#f8bbd0",
  "Technology": "#c8e6c9"
};

fetch(API_URL)
.then(res=>res.json())
.then(data=>{
  const container=document.getElementById("books");
  if(!data || data.length===0){container.innerHTML="<p>No books found.</p>"; return;}

  data.forEach(book=>{
    const div=document.createElement("div"); div.className="book";
    const authors = book.authors && book.authors.length>0 ? book.authors.map(a=>a.name||a).join(", ") : "Unknown";
    const bgColor = categoryColors[book.category]||"rgba(245,245,220,0.12)";
    div.style.background=bgColor;
    const copyType = book.hardcover ? "Hardcover" : "Softcopy";

    div.innerHTML=`
      <div class="cover">
        <img src="${book.coverImageUrl||'https://via.placeholder.com/220x280'}" alt="Cover">
        <div class="overlay">${book.category||"Book"}</div>
        <div class="badge">${copyType}</div>
      </div>
      <div class="info">
        <h3>${book.title}</h3>
        <p><strong>Year:</strong> ${book.year}</p>
        <p><strong>Authors:</strong> ${authors}</p>
        <p><strong>Rating:</strong> ${book.rating||0} / 5</p>
      </div>
    `;

    div.addEventListener("click",()=>{
      const actions=[];
      if(book.saleType==="BUY"||book.saleType==="BOTH") actions.push(`<button class="btn btn-buy">Buy - $${book.purchasePrice||0}</button>`);
      if(book.saleType==="RENT"||book.saleType==="BOTH") actions.push(`<button class="btn btn-rent">Rent - $${book.price||0}</button>`);
      const stars = "★".repeat(Math.round(book.rating||0)) + "☆".repeat(5 - Math.round(book.rating||0));

      modalBody.innerHTML=`
        <div style="display:flex; gap:20px; align-items:flex-start; flex-wrap:wrap;">
          <div style="flex:0 0 160px;">
            <img src="${book.coverImageUrl||'https://via.placeholder.com/300x400'}" alt="Cover" style="width:100%; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.6);">
          </div>
          <div style="flex:1; font-size:14px; color:#fff; display:flex; flex-direction:column; gap:8px;">
            <h2 style="margin-bottom:10px;">${book.title}</h2>
            <p><strong>Authors:</strong> ${authors}</p>
            <p><strong>Year:</strong> ${book.year}</p>
            <p><strong>Category:</strong> ${book.category}</p>
            <p><strong>Rating:</strong> <span style="color:#ffb400; font-size:16px;">${stars}</span></p>
            <div style="background: rgba(255,255,255,0.05); padding:12px; border-radius:12px;">
              <p><strong>Description:</strong></p>
              <p style="font-size:13px; color:#ddd; line-height:1.5;">${book.description||"No description available."}</p>
            </div>
            <div style="display:flex; gap:15px; flex-wrap:wrap;">
              <p><strong>Total Copies:</strong> ${book.totalCopies||0}</p>
              <p><strong>Loan Count:</strong> ${book.loanCount||0}</p>
              <p><strong>Sale Type:</strong> ${book.saleType||"-"}</p>
              <p><strong>Rent Price:</strong> $${book.price||0}</p>
              <p><strong>Purchase Price:</strong> $${book.purchasePrice||0}</p>
              <p><strong>Copy Type:</strong> ${copyType}</p>
            </div>
            <div class="actions">${actions.join("")}</div>
          </div>
        </div>
      `;
      openModal(bookModal);
    });

    container.appendChild(div);
  });
})
.catch(err=>{
  document.getElementById("books").innerHTML="❌ Error loading books: "+err;
  console.error(err);
});
</script>
</body>
</html>
